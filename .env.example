# =========================
# Required: DefectDojo
# =========================
DOJO_BASE_URL=http://dojo.local:8080/api/v2
DOJO_API_TOKEN=replace-with-real-token

# =========================
# Required: Sub-workflow IDs (used by WF_Dojo_Master executeWorkflow nodes)
# =========================
N8N_WF_A_ID=<workflow_id_WF_A_Subdomains_PT>
N8N_WF_B_ID=<workflow_id_WF_B_Nmap_Product>
N8N_WF_C_ID=<workflow_id_WF_C_Targets_For_PT>
N8N_WF_D_ID=<workflow_id_WF_D_PT_AcunetixScan>

# =========================
# Required: Acunetix config (choose ONE mode)
# =========================
# MODE A (recommended): multi-node pool
# - If ACUNETIX_INSTANCES_JSON is set and valid, it is used as primary source.
# - Fields per node: name, endpoint, api_key (recommended), optional max_scans_per_node/scan_limit, weight.
ACUNETIX_INSTANCES_JSON=[{"name":"acu-1","endpoint":"https://acu-1.local:3443","api_key":"token1","max_scans_per_node":5,"weight":2},{"name":"acu-2","endpoint":"https://acu-2.local:3443","api_key":"token2","max_scans_per_node":5,"weight":1}]

# MODE B (fallback): single-node
# Used only when ACUNETIX_INSTANCES_JSON is empty/absent.
ACUNETIX_BASE_URL=https://acu-1.local:3443
ACUNETIX_API_KEY=replace-with-real-token

# Legacy fallback (transition period only)
# ACU_API_TOKEN=replace-with-real-token

# =========================
# Required: persistent SQLite mapping store
# =========================
# Must point to /data/... (workflow validates this)
ACUNETIX_MAPPING_DB=/data/n8n/acunetix_mapping_store.sqlite3

# =========================
# Runtime limits (recommended to set explicitly)
# =========================
SUBDOMAINS_CONCURRENCY=5
SUBDOMAINS_RUNNING_TIMEOUT_MINUTES=60
NMAP_CONCURRENCY=5
PT_WINDOW_SIZE=300

PT_LOCK_TTL_MINUTES=20
PT_RETRY_SUBDOMAINS_MAX=3
PT_RETRY_NMAP_MAX=3
PT_RETRY_TARGETS_MAX=3
PT_RETRY_ACU_MAX=3

ACUNETIX_MAX_SCANS_PER_NODE=5
ACUNETIX_NODE_SELECTION_POLICY=least_loaded
ACUNETIX_STICKY_ASSIGNMENT=true

# =========================
# Optional / diagnostics
# =========================
# Used by WF_E_System_Health n8n availability check
N8N_BASE_URL=http://localhost:5678

# Used by nmap processing scripts
NMAP_XML_DIR=/tmp
PT_TARGETS_ARTIFACT_DIR=/tmp
EXCLUDE_PORTS=80,443

# Health/reporting windows
PT_HEALTH_WINDOW_SIZE=300
HEALTH_MAX_LOG_EVENTS=500
